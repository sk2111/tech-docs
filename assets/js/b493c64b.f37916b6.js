"use strict";(self.webpackChunktech_docs=self.webpackChunktech_docs||[]).push([[8812],{718:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>p,frontMatter:()=>c,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"tech/devops/Section 3/slide1","title":"K8\'s Env","description":"1. In any application, we have certain configuration values that are required for","source":"@site/docs/tech/devops/Section 3/slide1.md","sourceDirName":"tech/devops/Section 3","slug":"/tech/devops/Section 3/slide1","permalink":"/tech-docs/docs/tech/devops/Section 3/slide1","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/tech/devops/Section 3/slide1.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"sidebar_label":"K8\'s Env"},"sidebar":"techDocsSidebar","previous":{"title":"Practice Time","permalink":"/tech-docs/docs/tech/devops/Section 2/slide7"},"next":{"title":"K8\'s Config Maps","permalink":"/tech-docs/docs/tech/devops/Section 3/slide2"}}');var i=s(4848),a=s(8453);const c={sidebar_position:1,sidebar_label:"K8's Env"},t="K8's Env",l={},o=[{value:"Practice Time - Env Variables",id:"practice-time---env-variables",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"k8s-env",children:"K8's Env"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"In any application, we have certain configuration values that are required for\r\nthe application to run."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"These configuration values are generally passed as environment variables."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["In K8's, we can pass environment variables to our pods using the ",(0,i.jsx)(n.code,{children:"env"})," field\r\nin the pod specification."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["In the case of ",(0,i.jsx)(n.code,{children:"deployment"})," we can pass environment variables in the same way\r\nas we do in pods."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'apiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: backend\r\n  labels:\r\n    app: backend\r\nspec:\r\n  replicas: 3\r\n  selector:\r\n    matchLabels:\r\n      app: backend\r\n  template:\r\n    metadata:\r\n      labels:\r\n        app: backend\r\n    spec:\r\n      containers:\r\n        - image: sathish1996/node-app:1.0.0\r\n          imagePullPolicy: Always\r\n          name: backend\r\n          ports:\r\n            - containerPort: 4000\r\n          env:\r\n            - name: APP_NAME\r\n              value: "I am awesome node app"\r\n            - name: LOG_LEVEL\r\n              value: "DEBUG"\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"practice-time---env-variables",children:"Practice Time - Env Variables"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["You can edit the python app or node js app from previous practice to read the\r\nenvironment variable ",(0,i.jsx)(n.code,{children:"APP_NAME"})," and return it in the response."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'app.get("/", (req, res) => {\r\n  const env = {\r\n    APP_NAME: process.env.APP_NAME,\r\n    LOG_LEVEL: process.env.LOG_LEVEL,\r\n  };\r\n\r\n  res.json({\r\n    message: "Environment Variables",\r\n    env: env,\r\n  });\r\n});\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Rebuild the docker image and push it to docker hub."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Update the deployment yaml file to include the env variable as shown above."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Cleanup the existing deployment using the below command"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"kubectl delete deployment --all\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Apply the new deployment using the below command"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"kubectl apply -f deployment.yaml\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Verify the pods are recreated using the below command"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"kubectl get pods\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Access the application using the service & minikube service URL & verify the\r\nresponse contains the environment variable value."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Tip"}),": To debug the environment variables in the pod, you can exec into the\r\npod and run the ",(0,i.jsx)(n.code,{children:"printenv"})," command."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:" kubectl exec -it <pod-name> -- sh\r\n printenv\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:" minikube kubectl -- exec -it <pod-name> -- sh\r\n printenv\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"k8s_env_1",src:s(1207).A+"",width:"884",height:"321"})})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},1207:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/k8s_env_1-91d69cee8b9f80a0cff6091dbf2cb753.png"},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>t});var r=s(6540);const i={},a=r.createContext(i);function c(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);