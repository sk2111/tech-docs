"use strict";(self.webpackChunktech_docs=self.webpackChunktech_docs||[]).push([[3416],{464:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/k8s_secret_5-69ec98d609f1edcf57aeb1eb61a189ec.png"},7787:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>p,frontMatter:()=>c,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"tech/devops/Section 3/slide3","title":"K8\'s Secrets","description":"1. In K8\'s, Secrets are used to store sensitive information such as passwords,","source":"@site/docs/tech/devops/Section 3/slide3.md","sourceDirName":"tech/devops/Section 3","slug":"/tech/devops/Section 3/slide3","permalink":"/tech-docs/docs/tech/devops/Section 3/slide3","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/tech/devops/Section 3/slide3.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"sidebar_label":"K8\'s Secrets"},"sidebar":"techDocsSidebar","previous":{"title":"K8\'s Config Maps","permalink":"/tech-docs/docs/tech/devops/Section 3/slide2"},"next":{"title":"K8\'s Scaling & Resource","permalink":"/tech-docs/docs/tech/devops/Section 3/slide4"}}');var t=s(4848),a=s(8453);const c={sidebar_position:2,sidebar_label:"K8's Secrets"},i="K8's Secrets",o={},l=[{value:"Create a Opaque secret",id:"create-a-opaque-secret",level:2}];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"k8s-secrets",children:"K8's Secrets"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"In K8's, Secrets are used to store sensitive information such as passwords,\r\nOAuth tokens, and ssh keys."}),"\n",(0,t.jsx)(n.li,{children:"Secrets are similar to ConfigMaps but are specifically designed to hold\r\nconfidential data."}),"\n",(0,t.jsx)(n.li,{children:"Secrets are stored in an encoded format (base64) to provide a basic level of security."}),"\n",(0,t.jsx)(n.li,{children:"We have multiple types of secrets like Opaque, Docker Registry, TLS, basic,\r\nssh, k8's token etc."}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Important"}),": While Secrets provide a basic level of security by encoding\r\nthe data, they are not encrypted by default."]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"important",children:(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["With native K8's ",(0,t.jsx)(n.strong,{children:"secrets are not encrypted by default"}),"."]}),"\n",(0,t.jsx)(n.li,{children:"For enhanced security, consider using additional encryption mechanisms or\r\ntools like K8's Encryption at Rest or external secret management solutions."}),"\n",(0,t.jsx)(n.li,{children:"Always follow best practices for managing sensitive data in your applications."}),"\n",(0,t.jsx)(n.li,{children:"In real projects, we store secrets in external secret management tools\r\nlike HashiCorp Vault, AWS Secrets Manager, Azure Key Vault,\r\nGithub Secrets, etc., and inject them into K8's at runtime."}),"\n",(0,t.jsx)(n.li,{children:"Managed K8's services like GKE, EKS, AKS provide integration with\r\ntheir respective secret management services for better security."}),"\n"]})}),"\n",(0,t.jsx)(n.h2,{id:"create-a-opaque-secret",children:"Create a Opaque secret"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Opaque type Secrets can be created using yaml files."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\r\nkind: Secret\r\nmetadata:\r\n  name: app-secret\r\ntype: Opaque\r\ndata:\r\n  # base64 encoded value of 'password123' injected from external secret\r\n  # manager in production\r\n  DB_PASSWORD: cGFzc3dvcmQxMjM=\r\n  # base64 encoded value of 'apikey123456'\r\n  # manager in production\r\n  API_KEY: YXBpa2V5MTIzNDU2\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Apply the secret using the below command"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:" kubectl apply -f secret.yaml\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Verify whether the secret is created using the below command"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:" kubectl get secrets\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Now update the deployment yaml to use the secret as shown below"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: backend\r\n  labels:\r\n    app: backend\r\nspec:\r\n  replicas: 3\r\n  selector:\r\n    matchLabels:\r\n      app: backend\r\n  template:\r\n    metadata:\r\n      labels:\r\n        app: backend\r\n    spec:\r\n      containers:\r\n        - image: sathish1996/node-app:1.0.0\r\n          imagePullPolicy: Always\r\n          name: backend\r\n          ports:\r\n            - containerPort: 4000\r\n          envFrom:\r\n            - configMapRef:\r\n                name: app-config\r\n            - secretRef:\r\n                name: app-secret\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"This will pass all the key value pairs from the secret as environment variables\r\nto the pod."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Apply the deployment using the below command"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:" kubectl apply -f deployment.yaml\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Verify the pods are recreated using the below command"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:" kubectl get pods\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Use the below command to exec into the pod and verify the secret values are\r\navailable as environment variables"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:" kubectl exec -it <pod-name> -- sh\r\n\r\n printenv\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:" minikube kubectl -- exec -it <pod-name> -- sh\r\n\r\n printenv\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"k8s_secret_5",src:s(464).A+"",width:"1072",height:"710"})})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>i});var r=s(6540);const t={},a=r.createContext(t);function c(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);